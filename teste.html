<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chorinho Premium üé∂ - Conte√∫do Exclusivo</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <nav>
            <div class="logo-with-image">
                Chorinho Premium 
            </div>
            <div class="nav-links">
                <!-- Bot√£o de logout removido pois n√£o √© necess√°rio nesta p√°gina -->
            </div>
        </nav>
    </header>

    <div id="message"></div>
    
    <!-- Conte√∫do principal da p√°gina -->
    <main class="app-container" id="app-container">
        <section class="hero">
            <h1>Bem-vindo ao Clube do Chorinho</h1>
            <p>O melhor acervo de m√∫sicas exclusivas, atualizado semanalmente.</p>
        </section>

        <section class="music-list-section">
            <h2>Lan√ßamentos e Cl√°ssicos</h2>
                <div style="text-align:center; margin-bottom:16px;">
                    <button id="openPlayerListBtn" style="padding:12px 24px; border-radius:8px; background:#222; color:#fff; font-size:1rem; border:none; cursor:pointer; font-weight:600;">Abrir Player Lista</button>
                </div>
            <div class="music-controls" style="margin-bottom:24px; display:flex; flex-wrap:wrap; gap:16px; align-items:center; justify-content:center;">
                <input type="text" id="searchInput" placeholder="Buscar m√∫sica ou artista..." style="padding:10px; border-radius:6px; border:1px solid #ccc; min-width:220px;">
                <select id="orderSelect" style="padding:10px; border-radius:6px; border:1px solid #ccc;">
                    <option value="recent">Rec√©m adicionadas</option>
                    <option value="alpha">Ordem alfab√©tica (t√≠tulo)</option>
                    <option value="artista">Por artista</option>
                </select>
            </div>
            
            <div class="music-grid" id="musicList">
                </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Chorinho Premium by Cristiano Ferreira | M√∫sica de qualidade.</p>
    </footer>

    <div id="playerListModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:9999; align-items:center; justify-content:center; animation:fadeIn 0.3s;">
        <div class="modal-player-content">
            <button id="closePlayerListModal" class="modal-close-button">&times;</button>
            <h3 class="modal-title">Sua Lista de Reprodu√ß√£o</h3>
            
            <div id="modalPlayerControls" class="modal-player-controls">
                </div>
            
            <div class="modal-music-list" id="modalMusicList">
                </div>
        </div>
    </div>
    
    <div id="sheetModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:10000; align-items:center; justify-content:center;">
        <div class="sheet-modal-content">
            <button id="closeSheetModal" class="modal-close-button" style="color: white; border: 2px solid white; border-radius: 50%; width: 30px; height: 30px; line-height: 1; padding: 0;">&times;</button>
            <iframe id="sheetViewer" src="" frameborder="0" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <!-- Modal de redirecionamento -->
    <div id="redirectModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:10001; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:30px; border-radius:10px; max-width:500px; width:90%; text-align:center;">
            <h3 style="margin-bottom:20px; color:#333;">Acesso Exclusivo</h3>
            <p style="margin-bottom:25px; color:#666;">Para ouvir, adicionar √† lista ou acessar partituras, voc√™ precisa fazer parte do nosso clube.</p>
            <button id="redirectToVenda" style="padding:12px 24px; background:#ff6b6b; color:#fff; border:none; border-radius:6px; font-size:1rem; cursor:pointer; font-weight:600;">Acessar a Plataforma</button>
            <button id="closeRedirectModal" style="margin-left:15px; padding:12px 24px; background:#ccc; color:#333; border:none; border-radius:6px; font-size:1rem; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <style>
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-player-content { 
            background: var(--background-light); 
            padding: 30px; 
            border-radius: 12px; 
            max-width: 500px; 
            width: 90%; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            max-height: 90vh; 
            overflow-y: auto;
        }
        .modal-close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.8rem;
            background: none;
            border: none;
            cursor: pointer;
            color: #555;
        }
        .modal-title {
            text-align: center;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        #modalAudioPlayer {
            width: 100%;
            margin-bottom: 15px;
        }
        .modal-music-list { width: 100%; margin-top: 10px; max-height: 200px; overflow-y: auto; padding-right: 5px; }
        .modal-music-list > div { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            margin-bottom: 8px; 
            background: #fff; 
            border-radius: 8px; 
            padding: 8px 12px; 
            box-shadow: 0 1px 4px rgba(0,0,0,0.07);
        }
        .modal-music-list span { flex: 1; font-size: 0.9em; }
        
        .modal-music-list button { 
            border: none; 
            border-radius: 4px; 
            padding: 4px 8px; 
            cursor: pointer; 
            font-size: 0.8rem; 
            transition: background 0.2s; 
        }
        .modal-music-list button.remove { background: #ff5252; color:#fff; }
        .modal-music-list button.remove:hover { background: #e53935; }
        .modal-music-list button:not(.remove) { background: #667eea; color:#fff; }
        .modal-music-list button:not(.remove):hover { background: #5a6edb; }
        .modal-music-list button:disabled { background: #bdbdbd; cursor: not-allowed; }
        
        @media (max-width: 600px) { 
            .modal-player-content { max-width: 98vw; padding: 18px 4vw 12px 4vw; } 
            .modal-title { font-size: 1.3rem; } 
            .modal-music-list > div { font-size: 0.95rem; } 
        }
        
        /* Estilos do Modal de Partitura */
        .sheet-modal-content {
            background: var(--background-dark); 
            padding: 10px; 
            border-radius: 12px; 
            max-width: 90%; 
            max-height: 90%; 
            width: 900px; 
            height: 90vh;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #closeSheetModal {
            position: absolute;
            top: -15px;
            right: -15px;
            font-size: 1.5rem;
            background: #ff6b6b;
            z-index: 10001; 
            color: white !important;
        }
        @media (max-width: 768px) {
             .sheet-modal-content {
                max-width: 95%; 
                max-height: 95%; 
                height: 95vh;
             }
             #closeSheetModal {
                top: 5px; 
                right: 5px;
                background: #ff6b6b;
             }
        }
    </style>

    <script>
        // Fun√ß√£o para carregar a lista de m√∫sicas
        function loadMusicList() {
            const musicListContainer = document.getElementById('musicList');
            musicListContainer.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #888;">Carregando m√∫sicas...</p>';
            
            // Simular carregamento de m√∫sicas (em uma implementa√ß√£o real, isso viria do Firebase)
            setTimeout(() => {
                // Exemplo de dados de m√∫sicas
                const musicas = [
                    {
                        titulo: "Brasileirinho",
                        artista: "Waldir Azevedo",
                        data: "2025-01-15",
                        arquivo: "brasileirinho.mp3",
                        partitura: "https://exemplo.com/partituras/brasileirinho.pdf"
                    },
                    {
                        titulo: "Tico-Tico no Fub√°",
                        artista: "Zequinha de Abreu",
                        data: "2025-01-10",
                        arquivo: "tico-tico.mp3",
                        partitura: "https://exemplo.com/partituras/tico-tico.pdf"
                    },
                    {
                        titulo: "Naquele Tempo",
                        artista: "Jacob do Bandolim",
                        data: "2025-01-05",
                        arquivo: "naquele-tempo.mp3",
                        partitura: "https://exemplo.com/partituras/naquele-tempo.pdf"
                    }
                ];
                
                renderMusicList(musicas);
            }, 1000);
        }
        
        // Fun√ß√£o para renderizar a lista de m√∫sicas
        function renderMusicList(musicas) {
            const musicListContainer = document.getElementById('musicList');
            musicListContainer.innerHTML = '';
            
            if (musicas.length === 0) {
                musicListContainer.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #888;">Nenhuma m√∫sica encontrada.</p>';
                return;
            }
            
            musicas.forEach(musica => {
                const card = document.createElement('div');
                card.className = 'music-card';
                
                // Formata a data
                const date = new Date(musica.data);
                const formattedDate = isNaN(date.getTime()) ? 'N/A' : date.toLocaleDateString('pt-BR');
                
                card.innerHTML = `
                    <h3>${musica.titulo || 'T√≠tulo Desconhecido'}</h3>
                    <p>Artista: ${musica.artista || 'N/A'}</p>
                    <p>Lan√ßamento: ${formattedDate}</p>
                    
                    <audio controls class="audio-player" 
                           data-src="#"
                           controlsList="nodownload" 
                           preload="none"
                           crossorigin="anonymous"
                           style="width: 100%; height: 40px; margin-top: 10px;">
                        Seu navegador n√£o suporta o elemento de √°udio.
                    </audio>
                    
                    <button class="add-to-playlist-btn" 
                            data-musica-arquivo="${musica.arquivo}" 
                            title="Adicionar √† Lista" 
                            style="display: block; width: 100%; margin-top: 12px; background-color: var(--primary-color) !important; color: var(--text-light) !important; border: none; padding: 10px 15px !important; border-radius: 6px !important; cursor: pointer; font-size: 0.9em !important; font-weight: 600;">
                        + Adicionar √† Lista 
                    </button>
                    
                    ${musica.partitura && musica.partitura !== '' ? `
                        <button class="open-sheet-btn" 
                                title="Abrir Partitura" 
                                style="display: block; width: 100%; margin-top: 8px; background-color: #4CAF50 !important; color: var(--text-light) !important; border: none; padding: 10px 15px !important; border-radius: 6px !important; cursor: pointer; font-size: 0.9em !important; font-weight: 600;">
                            Ver Partitura üéº 
                        </button>` : ''}
                `;
                
                musicListContainer.appendChild(card);
            });
        }
        
        // Carregar a lista de m√∫sicas quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            loadMusicList();
        });
        
        // Mostrar o modal de redirecionamento quando os bot√µes forem clicados
        document.addEventListener('click', function(e) {
            // Verifica se o clique foi em um bot√£o de a√ß√£o
            if (e.target.classList.contains('add-to-playlist-btn') || 
                e.target.classList.contains('open-sheet-btn') ||
                e.target.id === 'openPlayerListBtn') {
                e.preventDefault();
                document.getElementById('redirectModal').style.display = 'flex';
            }
        });

        // Fechar o modal de redirecionamento
        document.getElementById('closeRedirectModal').addEventListener('click', function() {
            document.getElementById('redirectModal').style.display = 'none';
        });

        // Redirecionar para a p√°gina de vendas
        document.getElementById('redirectToVenda').addEventListener('click', function() {
            window.open('https://www.basesdechorinho.com.br/venda.html', '_blank');
        });

        // Fechar modais ao clicar fora
        document.getElementById('redirectModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // Fechar modal de player ao clicar fora
        document.getElementById('playerListModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // Fechar modal de partitura ao clicar fora
        document.getElementById('sheetModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
                document.getElementById('sheetViewer').src = '';
            }
        });
        
        // Bot√µes de fechar modais
        document.getElementById('closePlayerListModal').addEventListener('click', function() {
            document.getElementById('playerListModal').style.display = 'none';
        });
        
        document.getElementById('closeSheetModal').addEventListener('click', function() {
            document.getElementById('sheetModal').style.display = 'none';
            document.getElementById('sheetViewer').src = '';
        });
    </script>

    <!-- Mant√©m os scripts originais para funcionalidades b√°sicas -->
    <script type="module" src="./firebase-config.js"></script>
    </body>
</html>